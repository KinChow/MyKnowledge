# 时域降噪

## 时域降噪的背景、原理

背景介绍：

* 图像内容在帧间具有很强的相关性，且每一帧内都是连续变化的；
* 图像噪声在帧问总是随机出现，不具有相关性，每帧内也是不连续的。



基本思想：

时域滤波利用噪声在帧间随机的、不连续的特点进行降噪。



## 时域降噪的常用算法、基本步骤

基本方法：

* 多图平均算法：主要应用于拍照场景隆噪
* 运动估计算法：主要应用于视频场景降噪



### 多图平均算法

其核心思想就是针对同一场景拍摄多张图，进行加权平均处理。

* 开始
* 输入多张连续图片
* 图片序列配准对齐
* 像素加权平均处理
* 输出合成图像
* 结束



### 运动估计算法

先进行运动估计，然后沿着物体运动方向进行降噪处理



### 运动补偿算法

视频噪声特征分析：

*    每一帧的图像内容具有高度相关性。
*    高斯噪声在帧间不具有连续性。



时域降噪处理模型：

*    在时域上很好地获得物体的运动轨迹
*   沿着物体的运动轨迹对噪声进行有效的滤波



运动估计算法原理：

*    当前帧分为一定数量互不重叠的块，把前一帧作为参考帧。
*    在参考帧中按一定原则和策略找到和当前块最相近的参考块。



### 梯度方向算法

基本思想：

通过分析帧内领域像素特点，使用方向梯度原理，将像素点分为噪声点、边界点和内部点。只对帧间噪声点进行时域降噪处理。



算法优点：

*    该降噪算法在去除视频序列噪声的同时，也能很好地保护图像的细节。
*    通过像素点的划分，减少的不必要的计算量，以提升了算法性能。



### MASTF算法

算法全称：MOTION ADAPTIVE SPATIO-TEMPORAL FILTER.



运动自适应降噪滤波器的框图。有五个重要步骤：

1.    Moving Pixel Detection
2.    Temporal Average Filter
3.    Spatio-Temporal Noise Reduction Filter
4.    Image Fusion
5. 2-D Adaptive Filter in Static Regions



主要特点：

1.   根据运动检测对图像进行分区，即静态区域和动态区域；
2.    对静态区域直接使用时域多图平均算法；
3.    对动态区域使用时空域结合算法，并用到了运动补偿算法。



算法优势：

在取得较好降噪效果的同时，也能获得较好的降噪性能。



## 时域降噪的问题、难点和优化方法

### 时域降噪问题

*    配准问题：对于拍照多帧融合去噪处理时，如果图像对齐处理不好，会导致融合后图像模糊；
*    拖影问题：对于剧烈运动、变化较快的图像，容易产生“拖影”问题；
*    性能问题：对于视频降噪中，对实时性、流畅性要求就高，参考帧选择不当会严重影响视频体验。

2D降噪会牺牲清晰度，降噪强度越高相应画面清晰度会下降越严重。

3D降噪会增加移动目标拖影，降噪强度越高，拖影越厉害。



### 优化方法

优化配准

* 保证拍摄图像的稳定
*   控制前后参考帧数量
*  结合运动检测的算法

减少拖影
* 优化运动估计算法
*  计算物体运动强度
*   选择合适融合帧数

提高性能
* 图像的运动检测分区
*   图像的噪声进行分类
*   选择合适的融合帧数